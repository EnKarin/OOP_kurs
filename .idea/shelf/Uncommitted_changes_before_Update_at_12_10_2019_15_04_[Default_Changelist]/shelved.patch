Index: src/Beings/Carnivorous.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package Beings;\r\n\r\nimport java.util.Set;\r\n\r\npublic class Carnivorous extends Animals{\r\n\r\n    public Carnivorous(boolean male, int maxHp, int x, int y, double speed){\r\n        super(male, maxHp, x, y, speed);\r\n    }\r\n\r\n    void reproduction(Set<Beings> unit){ //размножение хищников\r\n        final Carnivorous mam = (Carnivorous) searchPartner(unit, Carnivorous.class);\r\n        if(mam != null) {\r\n            int distance = (int) Math.sqrt(Math.pow(x - mam.x, 2) + Math.pow(y - mam.y, 2));\r\n            final double sin = (mam.y - y) / distance;\r\n            final double cos = (mam.x - x) / distance;\r\n            x += speed * cos;\r\n            y += speed * sin;\r\n            if (Math.abs(x - mam.x) <= 3 && Math.abs(y - mam.y) <= 3) {\r\n                currentHp -= maxHp * 0.15;\r\n                unit.add(new Carnivorous(rand.nextBoolean(),(int)(maxHp * 0.8 + rand.nextInt((int) Math.abs(maxHp\r\n                        - mam.maxHp) + 1)), (int)(x + 15), (int)(y + 15), speed * 0.8 + rand.nextInt((int)(Math.abs(speed\r\n                        - mam.speed)) + 1)));\r\n            }\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n    }\r\n\r\n    private Herbivorous hunger(Set<Beings> unit){ //поиск еды\r\n        Herbivorous temp = (Herbivorous) search(unit, Herbivorous.class);\r\n        if(temp != null) {\r\n            int distance = (int) Math.sqrt(Math.pow(x - temp.x, 2) + Math.pow(y - temp.y, 2));\r\n            if (distance <= 500 && temp.currentHp <= currentHp) {\r\n                return temp;\r\n            }\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private void pursuit(Set<Beings> unit){ //преследование добычи\r\n        final Herbivorous hunger = hunger(unit);\r\n        if(hunger != null) {\r\n            final int distance = (int) Math.sqrt(Math.pow(x - hunger.x, 2) + Math.pow(y - hunger.y, 2));\r\n            final double sin = (hunger.y - y) / distance;\r\n            final double cos = (hunger.x - x) / distance;\r\n            x += 2 * speed * cos;\r\n            y += 2 * speed * sin;\r\n            currentHp -= 0.002;\r\n            if(Math.abs(x - hunger.x) <= 3 && Math.abs(y - hunger.y) <= 3){\r\n                currentHp += hunger.currentHp * 0.8;\r\n                hunger.currentHp = 0;\r\n            }\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n    }\r\n\r\n    public boolean live(Set<Beings> unit){\r\n        check();\r\n        currentHp -= 0.01;\r\n        age += 0.002;\r\n        if(currentHp <= 0){\r\n            return false;\r\n        }\r\n        else if(rand.nextInt((int)age + 1) == 15){\r\n            return false;\r\n        }\r\n        else if(currentHp < maxHp * 0.7){\r\n            pursuit(unit);\r\n        }\r\n        else if(currentHp >= maxHp * 0.5 && age >= 0.5 && age <= 1){\r\n            reproduction(unit);\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n        return true;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/Beings/Carnivorous.java	(revision 7481bd06cfa025a42557ebb9652dc02c7f614bde)
+++ src/Beings/Carnivorous.java	(date 1570867249024)
@@ -17,7 +17,7 @@
             x += speed * cos;
             y += speed * sin;
             if (Math.abs(x - mam.x) <= 3 && Math.abs(y - mam.y) <= 3) {
-                currentHp -= maxHp * 0.15;
+                currentHp -= currentHp * 0.15;
                 unit.add(new Carnivorous(rand.nextBoolean(),(int)(maxHp * 0.8 + rand.nextInt((int) Math.abs(maxHp
                         - mam.maxHp) + 1)), (int)(x + 15), (int)(y + 15), speed * 0.8 + rand.nextInt((int)(Math.abs(speed
                         - mam.speed)) + 1)));
@@ -52,7 +52,7 @@
             y += 2 * speed * sin;
             currentHp -= 0.002;
             if(Math.abs(x - hunger.x) <= 3 && Math.abs(y - hunger.y) <= 3){
-                currentHp += hunger.currentHp * 0.8;
+                currentHp += hunger.currentHp;
                 hunger.currentHp = 0;
             }
         }
@@ -68,7 +68,7 @@
         if(currentHp <= 0){
             return false;
         }
-        else if(rand.nextInt((int)age + 1) == 15){
+        else if(rand.nextInt((int)age + 1) == 50){
             return false;
         }
         else if(currentHp < maxHp * 0.7){
Index: src/Beings/Herbivorous.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package Beings;\r\n\r\nimport java.util.Set;\r\n\r\npublic class Herbivorous extends Animals {\r\n\r\n    public Herbivorous(boolean male, int maxHp, int x, int y, double speed) {\r\n        super(male, maxHp, x, y, speed);\r\n    }\r\n\r\n    void reproduction(Set<Beings> unit) { //размножение травоядных\r\n        final Herbivorous mam = (Herbivorous) searchPartner(unit, Herbivorous.class);\r\n        if (enemy(unit) == null && mam != null) {\r\n            int distance = (int) Math.sqrt(Math.pow(x - mam.x, 2) + Math.pow(y - mam.y, 2));\r\n            final double sin = (mam.y - y) / distance;\r\n            final double cos = (mam.x - x) / distance;\r\n            x += speed * cos;\r\n            y += speed * sin;\r\n            if (Math.abs(x - mam.x) <= 3 && Math.abs(y - mam.y) <= 3) {\r\n                currentHp -= maxHp * 0.15;\r\n                unit.add(new Herbivorous(rand.nextBoolean(),(int)(maxHp * 0.8 + rand.nextInt((int) Math.abs(maxHp\r\n                        - mam.maxHp) + 1)), (int)(x + 15), (int)(y + 15), speed * 0.8 + rand.nextInt((int)(Math.abs(speed\r\n                        - mam.speed)) + 1)));\r\n            }\r\n        }\r\n        else if (enemy(unit) != null) {\r\n            escape(unit);\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n    }\r\n\r\n    private Carnivorous enemy(Set<Beings> unit) { //проверка есть ли опасность\r\n        final Carnivorous temp = (Carnivorous) search(unit, Carnivorous.class);\r\n        if (temp != null && (int) Math.sqrt(Math.pow(x - temp.x, 2) + Math.pow(y - temp.y, 2)) <= 300\r\n                && temp.currentHp >= currentHp) {\r\n            return temp;\r\n        }\r\n        else return null;\r\n    }\r\n\r\n    private void escape(Set<Beings> unit) { //побег\r\n        final Carnivorous enemy = enemy(unit);\r\n        final int distance = (int) Math.sqrt(Math.pow(x - enemy.x, 2) + Math.pow(y - enemy.y, 2));\r\n        final double sin = (enemy.y - y) / distance;\r\n        final double cos = (enemy.x - x)/ distance;\r\n        x -= 2.3 * speed * cos;\r\n        y -= 2.3 * speed * sin;\r\n        currentHp -= 0.01;\r\n        if(Math.abs(x - enemy.x) <= 1 && Math.abs(y - enemy.y) <= 1){\r\n            live = false;\r\n        }\r\n    }\r\n\r\n    private void hunger(Set<Beings> unit){ //поиск еды\r\n        Plants temp = (Plants) search(unit, Plants.class);\r\n        if(temp != null) {\r\n            final int distance = (int) Math.sqrt(Math.pow(x - temp.x, 2) + Math.pow(y - temp.y, 2));\r\n            final double sin = (temp.y - y) / distance;\r\n            final double cos = (temp.x - x) / distance;\r\n            x += 2 * speed * cos;\r\n            y += 2 * speed * sin;\r\n            currentHp -= 0.005;\r\n            if (Math.abs(x - temp.x) <= currentHp && Math.abs(y - temp.y) <= currentHp) {\r\n                currentHp += temp.currentHp * 0.7;\r\n                temp.currentHp = 0;\r\n            }\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n    }\r\n\r\n    public boolean live(Set<Beings> unit){\r\n        check();\r\n\r\n        currentHp -= 0.01;\r\n        age += 0.002;\r\n        if(currentHp <= 0){\r\n            return false;\r\n        }\r\n        else if(rand.nextInt((int)age + 1) == 15){\r\n            return false;\r\n        }\r\n        else if(enemy(unit) != null){\r\n            escape(unit);\r\n            return live;\r\n        }\r\n        else if(currentHp < maxHp * 0.7){\r\n            hunger(unit);\r\n        }\r\n        else if(currentHp >= maxHp * 0.5 && age >= 0.5 && age <= 1){\r\n            reproduction(unit);\r\n        }\r\n        else {\r\n            movement();\r\n        }\r\n        return true;\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/Beings/Herbivorous.java	(revision 7481bd06cfa025a42557ebb9652dc02c7f614bde)
+++ src/Beings/Herbivorous.java	(date 1570867250750)
@@ -17,7 +17,7 @@
             x += speed * cos;
             y += speed * sin;
             if (Math.abs(x - mam.x) <= 3 && Math.abs(y - mam.y) <= 3) {
-                currentHp -= maxHp * 0.15;
+                currentHp -= currentHp * 0.15;
                 unit.add(new Herbivorous(rand.nextBoolean(),(int)(maxHp * 0.8 + rand.nextInt((int) Math.abs(maxHp
                         - mam.maxHp) + 1)), (int)(x + 15), (int)(y + 15), speed * 0.8 + rand.nextInt((int)(Math.abs(speed
                         - mam.speed)) + 1)));
@@ -63,7 +63,7 @@
             y += 2 * speed * sin;
             currentHp -= 0.005;
             if (Math.abs(x - temp.x) <= currentHp && Math.abs(y - temp.y) <= currentHp) {
-                currentHp += temp.currentHp * 0.7;
+                currentHp += temp.currentHp;
                 temp.currentHp = 0;
             }
         }
@@ -80,7 +80,7 @@
         if(currentHp <= 0){
             return false;
         }
-        else if(rand.nextInt((int)age + 1) == 15){
+        else if(rand.nextInt((int)age + 1) == 50){
             return false;
         }
         else if(enemy(unit) != null){
Index: src/Beings/Animals.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package Beings;\r\n\r\nimport java.util.Random;\r\nimport java.util.Set;\r\n\r\nabstract class Animals extends Beings {\r\n\r\n    double speed;\r\n    boolean live = true;\r\n    boolean goal = false;\r\n    private double globalsin = 0, globalcos = 0;\r\n    final Random rand = new Random();\r\n\r\n    Animals(boolean male, double maxHp, int x, int y, double speed) {\r\n        super(male, maxHp, x, y);\r\n        this.speed = speed;\r\n    }\r\n\r\n    void movement() {\r\n        rand.setSeed(0);\r\n        if(rand.nextInt(30) == 1 || globalcos == 0){\r\n            globalcos = rand.nextFloat() / Float.MAX_VALUE;\r\n            globalsin = 1 - globalcos;\r\n        }\r\n        x += speed / 2 * globalcos;\r\n        y += speed / 2 * globalsin;\r\n    }\r\n\r\n    abstract void reproduction(Set<Beings> unit);\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/Beings/Animals.java	(revision 7481bd06cfa025a42557ebb9652dc02c7f614bde)
+++ src/Beings/Animals.java	(date 1570867129631)
@@ -7,8 +7,7 @@
 
     double speed;
     boolean live = true;
-    boolean goal = false;
-    private double globalsin = 0, globalcos = 0;
+    private double globalSin = 0, globalCos = 0;
     final Random rand = new Random();
 
     Animals(boolean male, double maxHp, int x, int y, double speed) {
@@ -18,12 +17,12 @@
 
     void movement() {
         rand.setSeed(0);
-        if(rand.nextInt(30) == 1 || globalcos == 0){
-            globalcos = rand.nextFloat() / Float.MAX_VALUE;
-            globalsin = 1 - globalcos;
+        if(rand.nextInt(30) == 1 || globalCos == 0){
+            globalCos = rand.nextFloat() / Float.MAX_VALUE;
+            globalSin = 1 - globalCos;
         }
-        x += speed / 2 * globalcos;
-        y += speed / 2 * globalsin;
+        x += speed / 2 * globalCos;
+        y += speed / 2 * globalSin;
     }
 
     abstract void reproduction(Set<Beings> unit);
Index: src/Main/Main.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package Main;\r\n\r\nimport java.awt.event.*;\r\nimport java.awt.*;\r\nimport javax.swing.*;\r\nimport java.util.*;\r\nimport java.util.concurrent.ConcurrentHashMap;\r\n\r\nimport Beings.*;\r\n\r\npublic class Main extends JFrame{\r\n    int x = 0, y = 0;\r\n    static Set<Beings> set = Collections.newSetFromMap(new ConcurrentHashMap<>());\r\n\r\n    Main(){\r\n        setBounds(0, 0, 1370, 727);\r\n        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n        setVisible(true);\r\n        Panel panel = new Panel(set);\r\n        add(panel);\r\n        panel.setVisible(true);\r\n\r\n\r\n        addKeyListener(new KeyAdapter() {\r\n            @Override\r\n            public void keyPressed(KeyEvent e) {\r\n                super.keyTyped(e);\r\n                if(e.getKeyCode() == KeyEvent.VK_RIGHT && x < 1630 ){\r\n                    x+=50;\r\n                    panel.setxy(x, y);\r\n                    repaint();\r\n                }\r\n                else if(e.getKeyCode() == KeyEvent.VK_LEFT && x > 0){\r\n                    x-= 50;\r\n                    panel.setxy(x, y);\r\n                    repaint();\r\n                }\r\n                else if(e.getKeyCode() == KeyEvent.VK_UP && y > 0){\r\n                    y-=50;\r\n                    panel.setxy(x, y);\r\n                    repaint();\r\n                }\r\n                else if(e.getKeyCode() == KeyEvent.VK_DOWN && y < 2273){\r\n                    y+=50;\r\n                    panel.setxy(x, y);\r\n                    repaint();\r\n                }\r\n            }\r\n        });\r\n        while (true){\r\n            repaint(30, 0, 0, getWidth(), getHeight());\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        Random rand = new Random();\r\n        rand.setSeed(2);\r\n        for(int i = 0; i < 300; i++){\r\n            set.add(new Plants(new Random().nextBoolean(), rand.nextInt(35), rand.nextInt(3000), rand.nextInt(3000)));\r\n        }\r\n        for(int i = 0; i < 100; i++){\r\n            set.add(new Herbivorous(new Random().nextBoolean(), rand.nextInt(50), rand.nextInt(3000), rand.nextInt(3000),\r\n                    rand.nextDouble() * 10000 / Double.MAX_VALUE + 1));\r\n        }\r\n        for(int i = 0; i < 100; i++){\r\n            set.add(new Carnivorous(new Random().nextBoolean(), rand.nextInt(65), rand.nextInt(3000), rand.nextInt(3000),\r\n                    rand.nextDouble() * 10000 / Double.MAX_VALUE + 2));\r\n        }\r\n\r\n        new Main();\r\n    }\r\n}\r\n\r\nclass Panel extends JPanel{\r\n    int x, y;\r\n    Color red;\r\n    Set<Beings> set;\r\n\r\n    Panel(Set<Beings> set){\r\n        red = new Color(0xFF1109);\r\n        this.set = set;\r\n    }\r\n\r\n    void setxy(int xWindow, int yWindow){\r\n        x = xWindow;\r\n        y = yWindow;\r\n    }\r\n\r\n    @Override\r\n    protected void paintComponent(Graphics g) {\r\n        super.paintComponent(g);\r\n        if(x == 0){\r\n            g.setColor(red);\r\n            g.drawLine(1, 0, 1, getHeight());\r\n        }\r\n        else if(x > 1630){\r\n            g.setColor(red);\r\n            g.drawLine(getWidth() - 1, 0, getWidth() - 1, getHeight());\r\n        }\r\n        if(y == 0){\r\n            g.setColor(red);\r\n            g.drawLine(1, 1, getWidth() - 1, 1);\r\n        }\r\n        else if(y > 2273){\r\n            g.setColor(red);\r\n            g.drawLine(0, getHeight() - 1 ,getWidth(), getHeight() - 1);\r\n        }\r\n        for(Beings temp: set){\r\n            if(!temp.live(set)){\r\n                set.remove(temp);\r\n            }\r\n            else if (temp.getX() > x && temp.getX() < getWidth() + x && temp.getY() > y && temp.getY() < getHeight() + y){\r\n                if(temp.getClass().equals(Plants.class)){\r\n                    if(temp.isMale()){\r\n                        g.setColor(new Color(50, 177, 24));\r\n                    }\r\n                    else{\r\n                        g.setColor(new Color(156, 255, 17, 221));\r\n                    }\r\n                }\r\n                else if(temp.getClass().equals(Herbivorous.class)){\r\n                    if(temp.isMale()){\r\n                        g.setColor(new Color(0x216D89));\r\n                    }\r\n                    else{\r\n                        g.setColor(new Color(0x85247385, true));\r\n                    }\r\n                }\r\n                else {\r\n                    if(temp.isMale()){\r\n                        g.setColor(new Color(0x7C1923));\r\n                    }\r\n                    else{\r\n                        g.setColor(new Color(0xAE7A282D, true));\r\n\r\n                    }\r\n                }\r\n                g.fillOval(temp.getX() - x, temp.getY() - y, (int)(temp.getCurrentHp() / 2), (int)(temp.getCurrentHp() / 2));\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- src/Main/Main.java	(revision 7481bd06cfa025a42557ebb9652dc02c7f614bde)
+++ src/Main/Main.java	(date 1570867283533)
@@ -59,10 +59,10 @@
             set.add(new Plants(new Random().nextBoolean(), rand.nextInt(35), rand.nextInt(3000), rand.nextInt(3000)));
         }
         for(int i = 0; i < 100; i++){
-            set.add(new Herbivorous(new Random().nextBoolean(), rand.nextInt(50), rand.nextInt(3000), rand.nextInt(3000),
+            set.add(new Herbivorous(new Random().nextBoolean(), rand.nextInt(40), rand.nextInt(3000), rand.nextInt(3000),
                     rand.nextDouble() * 10000 / Double.MAX_VALUE + 1));
         }
-        for(int i = 0; i < 100; i++){
+        for(int i = 0; i < 200; i++){
             set.add(new Carnivorous(new Random().nextBoolean(), rand.nextInt(65), rand.nextInt(3000), rand.nextInt(3000),
                     rand.nextDouble() * 10000 / Double.MAX_VALUE + 2));
         }
@@ -108,6 +108,7 @@
         for(Beings temp: set){
             if(!temp.live(set)){
                 set.remove(temp);
+                System.out.println(set.size());
             }
             else if (temp.getX() > x && temp.getX() < getWidth() + x && temp.getY() > y && temp.getY() < getHeight() + y){
                 if(temp.getClass().equals(Plants.class)){
